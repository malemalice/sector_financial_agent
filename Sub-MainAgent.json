{
  "name": "Sub-MainAgent",
  "nodes": [
    {
      "parameters": {
        "model": "deepseek/deepseek-r1-0528-qwen3-8b:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        368,
        352
      ],
      "id": "cf08d740-533c-4ea1-920d-830b52608acf",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "GdgDPT3oPPGu9Km2",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        496,
        352
      ],
      "id": "c8850375-7696-4cd9-8538-978085cbb2f1",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "OKizlNAJO8RvWQ9Q",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        240,
        352
      ],
      "id": "2d68a314-2520-47c4-9e28-d4e5370c8388",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "K79HkkfIPqn0Is1J",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "needsFallback": true,
        "options": {
          "systemMessage": "## Role\nYou are MainAdvisor, a senior Financial Advisor at Algoritma Data Science School. Your job:\n* Understand the user’s intent.\n* Decide whether to answer directly or delegate to a specialized agent/tool.\n* Keep responses concise, structured, and actionable.\n\n## Tools\n1. Agent-SectorsApp → Agent specializing to perform API request to Sectors App API. Sectors App is an Indonensian Financial Data Platform providing access to financial data of almost all Indonesian company listed in IDX. use this Agent if user askin anything related to financial that need backed by data.\n2. Agent-WebSearch → News/real-time info, definitions you’re unsure about, methodology references, or cross-validation of surprising results.\n3. Vector Store Knowledge → Anything about Algoritma (programs, syllabus, policy, SOP, contacts).\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        528,
        128
      ],
      "id": "9ea7598a-e336-4e9a-9063-cf308882285c",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-embedding-001"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        704,
        560
      ],
      "id": "d3dea964-a3ff-4e41-b48d-328c0734f4a6",
      "name": "Embeddings Google Gemini1",
      "credentials": {
        "googlePalmApi": {
          "id": "K79HkkfIPqn0Is1J",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "use this tool to retrieve data from vector store. contains all knowledge about company data",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        624,
        352
      ],
      "id": "7eafc62e-2a36-4918-81a9-2d882624e572",
      "name": "VectorStore-CompanyKnowledge",
      "credentials": {
        "supabaseApi": {
          "id": "DQp2nHML55lPH4oR",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "description": "Agent specialized to call Sectors App API to retrieve real-time financial data",
        "workflowId": {
          "__rl": true,
          "value": "TzzgJfnDp733BmYa",
          "mode": "list",
          "cachedResultName": "Sub-SectorsApp"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        912,
        352
      ],
      "id": "147b391d-712f-4324-9e78-0cf97e9b8cc6",
      "name": "Sub-SectorsApp"
    },
    {
      "parameters": {
        "description": "AI Agent specialized in web search for retrieve real-time data and validate unsure opinion",
        "workflowId": {
          "__rl": true,
          "value": "HsRa0yJpfo1W6VA3",
          "mode": "list",
          "cachedResultName": "Sub-WebSearch"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        1040,
        352
      ],
      "id": "5b2c33e1-c638-4116-9f09-5f2806312324",
      "name": "Sub-WebSearch"
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "chatInput",
              "type": "any"
            },
            {
              "name": "sessionId"
            }
          ]
        }
      },
      "id": "2f0c9455-95bc-430f-8f0f-74c62b2e51cc",
      "typeVersion": 1.1,
      "name": "Start",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        320,
        128
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini1": {
      "ai_embedding": [
        [
          {
            "node": "VectorStore-CompanyKnowledge",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "VectorStore-CompanyKnowledge": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Sub-SectorsApp": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Sub-WebSearch": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Start": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "bbb2dc75-31a4-46df-85b6-dc52fa7b7ada",
  "meta": {
    "instanceId": "a7b791b7da220fb23693c1e4b82f9f8e97f7917c7d3d0049f3e52cb8cb2c26d1"
  },
  "id": "oyHmwpwYFB9FvKLq",
  "tags": []
}